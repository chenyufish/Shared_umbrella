{"ast":null,"code":"import \"core-js/modules/web.url-search-params.size.js\";\nexport default {\n  name: \"User\",\n  data() {\n    return {\n      currUser: JSON.parse(localStorage.getItem(\"currUser\")),\n      token: localStorage.getItem(\"token\"),\n      currentPage: 1,\n      pageLimits: [10, 20, 30, 40],\n      limit: 10,\n      itemTotal: 10,\n      users: [],\n      usersItem: {},\n      isAdmin: false // Add isAdmin variable\n    };\n  },\n\n  methods: {\n    getUserInfo() {\n      this.axios.get(\"http://localhost:8123/api/user/all\", {\n        params: {\n          token: this.token,\n          page: this.currentPage,\n          limit: this.limit\n        }\n      }, {\n        emulateJSON: true\n      }).then(resp => {\n        console.log(resp);\n        if (resp.data.message === \"ok\") {\n          this.itemTotal = resp.data.data.total;\n          this.users = resp.data.data.records;\n        }\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n    handleSizeChange(limit) {\n      this.limit = limit;\n      this.currentPage = 1;\n      this.getUserInfo(this.currentPage, this.limit);\n    },\n    handleCurrentChange(val) {\n      this.currentPage = val;\n      this.getUserInfo(this.currentPage, this.limit);\n    },\n    handleDelete(index, row) {\n      this.usersItem = row;\n      this.$confirm(\"账号注销后不可恢复, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        this.axios.defaults.headers.post[\"Content-Type\"] = \"application/x-www-form-urlencoded\";\n        const params = new URLSearchParams();\n        params.append(\"token\", this.token);\n        params.append(\"uId\", this.usersItem.uid);\n        this.axios.post(\"http://localhost:8123/api/user/delete\", params).then(resp => {\n          console.log(resp);\n          this.$message({\n            type: \"success\",\n            message: resp.data.message\n          });\n          this.getUserInfo();\n        }).catch(error => {\n          console.log(error);\n        });\n      }).catch(() => {\n        this.$message({\n          type: \"info\",\n          message: \"已取消删除\"\n        });\n      });\n    },\n    checkAdmin() {\n      if (this.currUser && this.currUser.role === 'admin') {\n        this.isAdmin = true;\n      } else {\n        this.isAdmin = false;\n      }\n    }\n  },\n  created() {\n    this.checkAdmin();\n    if (this.isAdmin) {\n      this.getUserInfo();\n    }\n  }\n};","map":{"version":3,"names":["name","data","currUser","JSON","parse","localStorage","getItem","token","currentPage","pageLimits","limit","itemTotal","users","usersItem","isAdmin","methods","getUserInfo","axios","get","params","page","emulateJSON","then","resp","console","log","message","total","records","catch","error","handleSizeChange","handleCurrentChange","val","handleDelete","index","row","$confirm","confirmButtonText","cancelButtonText","type","defaults","headers","post","URLSearchParams","append","uid","$message","checkAdmin","role","created"],"sources":["src/views/User/index.vue"],"sourcesContent":["<template>\n  <div>\n    <div v-if=\"isAdmin\">\n      <el-table\n          ref=\"multipleTable\"\n          :data=\"users\"\n          tooltip-effect=\"dark\"\n          style=\"width: 100%\"\n      >\n        <el-table-column\n            prop=\"uid\"\n            label=\"用户ID\"\n            width=\"120\"\n            sortable\n        ></el-table-column>\n        <el-table-column\n            prop=\"unickname\"\n            label=\"用户昵称\"\n            width=\"120\"\n        ></el-table-column>\n        <el-table-column prop=\"uphone\" label=\"用户联系方式\" width=\"120\">\n        </el-table-column>\n        <el-table-column prop=\"uemail\" label=\"用户邮箱\" width=\"120\">\n        </el-table-column>\n        <el-table-column\n            prop=\"uaddress\"\n            label=\"用户住址\"\n            show-overflow-tooltip\n        ></el-table-column>\n        <el-table-column prop=\"ulevel\" label=\"用户评价等级\" show-overflow-tooltip>\n        </el-table-column>\n\n        <el-table-column label=\"操作\">\n          <template slot-scope=\"scope\">\n            <el-button\n                size=\"mini\"\n                type=\"danger\"\n                @click=\"handleDelete(scope.$index, scope.row)\"\n            >注销账号</el-button\n            >\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :current-page=\"currentPage\"\n          :page-sizes=\"pageLimits\"\n          :page-size=\"limit\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"itemTotal\"\n      >\n      </el-pagination>\n    </div>\n    <div v-else>\n      <p>您没有权限查看此页面。</p>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"User\",\n  data() {\n    return {\n      currUser: JSON.parse(localStorage.getItem(\"currUser\")),\n      token: localStorage.getItem(\"token\"),\n      currentPage: 1,\n      pageLimits: [10, 20, 30, 40],\n      limit: 10,\n      itemTotal: 10,\n      users: [],\n      usersItem: {},\n      isAdmin: false, // Add isAdmin variable\n    };\n  },\n  methods: {\n    getUserInfo() {\n      this.axios\n          .get(\n              \"http://localhost:8123/api/user/all\",\n              {\n                params: {\n                  token: this.token,\n                  page: this.currentPage,\n                  limit: this.limit,\n                },\n              },\n              { emulateJSON: true }\n          )\n          .then((resp) => {\n            console.log(resp);\n            if (resp.data.message === \"ok\") {\n              this.itemTotal = resp.data.data.total;\n              this.users = resp.data.data.records;\n            }\n          })\n          .catch((error) => {\n            console.log(error);\n          });\n    },\n    handleSizeChange(limit) {\n      this.limit = limit;\n      this.currentPage = 1;\n      this.getUserInfo(this.currentPage, this.limit);\n    },\n    handleCurrentChange(val) {\n      this.currentPage = val;\n      this.getUserInfo(this.currentPage, this.limit);\n    },\n    handleDelete(index,row) {\n      this.usersItem = row;\n      this.$confirm(\"账号注销后不可恢复, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n          .then(() => {\n            this.axios.defaults.headers.post[\"Content-Type\"] =\n                \"application/x-www-form-urlencoded\";\n            const params = new URLSearchParams();\n            params.append(\"token\", this.token);\n            params.append(\"uId\", this.usersItem.uid);\n            this.axios\n                .post(\"http://localhost:8123/api/user/delete\", params)\n                .then((resp) => {\n                  console.log(resp);\n                  this.$message({\n                    type: \"success\",\n                    message: resp.data.message,\n                  });\n                  this.getUserInfo();\n                })\n                .catch((error) => {\n                  console.log(error);\n                });\n          })\n          .catch(() => {\n            this.$message({\n              type: \"info\",\n              message: \"已取消删除\",\n            });\n          });\n    },\n    checkAdmin() {\n      if (this.currUser && this.currUser.role === 'admin') {\n        this.isAdmin = true;\n      } else {\n        this.isAdmin = false;\n      }\n    }\n  },\n  created() {\n    this.checkAdmin();\n    if (this.isAdmin) {\n      this.getUserInfo();\n    }\n  },\n};\n</script>\n\n<style>\n</style>\n"],"mappings":";AA8DA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,QAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,KAAA,EAAAF,YAAA,CAAAC,OAAA;MACAE,WAAA;MACAC,UAAA;MACAC,KAAA;MACAC,SAAA;MACAC,KAAA;MACAC,SAAA;MACAC,OAAA;IACA;EACA;;EACAC,OAAA;IACAC,YAAA;MACA,KAAAC,KAAA,CACAC,GAAA,CACA,sCACA;QACAC,MAAA;UACAZ,KAAA,OAAAA,KAAA;UACAa,IAAA,OAAAZ,WAAA;UACAE,KAAA,OAAAA;QACA;MACA,GACA;QAAAW,WAAA;MAAA,CACA,EACAC,IAAA,CAAAC,IAAA;QACAC,OAAA,CAAAC,GAAA,CAAAF,IAAA;QACA,IAAAA,IAAA,CAAAtB,IAAA,CAAAyB,OAAA;UACA,KAAAf,SAAA,GAAAY,IAAA,CAAAtB,IAAA,CAAAA,IAAA,CAAA0B,KAAA;UACA,KAAAf,KAAA,GAAAW,IAAA,CAAAtB,IAAA,CAAAA,IAAA,CAAA2B,OAAA;QACA;MACA,GACAC,KAAA,CAAAC,KAAA;QACAN,OAAA,CAAAC,GAAA,CAAAK,KAAA;MACA;IACA;IACAC,iBAAArB,KAAA;MACA,KAAAA,KAAA,GAAAA,KAAA;MACA,KAAAF,WAAA;MACA,KAAAQ,WAAA,MAAAR,WAAA,OAAAE,KAAA;IACA;IACAsB,oBAAAC,GAAA;MACA,KAAAzB,WAAA,GAAAyB,GAAA;MACA,KAAAjB,WAAA,MAAAR,WAAA,OAAAE,KAAA;IACA;IACAwB,aAAAC,KAAA,EAAAC,GAAA;MACA,KAAAvB,SAAA,GAAAuB,GAAA;MACA,KAAAC,QAAA;QACAC,iBAAA;QACAC,gBAAA;QACAC,IAAA;MACA,GACAlB,IAAA;QACA,KAAAL,KAAA,CAAAwB,QAAA,CAAAC,OAAA,CAAAC,IAAA,mBACA;QACA,MAAAxB,MAAA,OAAAyB,eAAA;QACAzB,MAAA,CAAA0B,MAAA,eAAAtC,KAAA;QACAY,MAAA,CAAA0B,MAAA,aAAAhC,SAAA,CAAAiC,GAAA;QACA,KAAA7B,KAAA,CACA0B,IAAA,0CAAAxB,MAAA,EACAG,IAAA,CAAAC,IAAA;UACAC,OAAA,CAAAC,GAAA,CAAAF,IAAA;UACA,KAAAwB,QAAA;YACAP,IAAA;YACAd,OAAA,EAAAH,IAAA,CAAAtB,IAAA,CAAAyB;UACA;UACA,KAAAV,WAAA;QACA,GACAa,KAAA,CAAAC,KAAA;UACAN,OAAA,CAAAC,GAAA,CAAAK,KAAA;QACA;MACA,GACAD,KAAA;QACA,KAAAkB,QAAA;UACAP,IAAA;UACAd,OAAA;QACA;MACA;IACA;IACAsB,WAAA;MACA,SAAA9C,QAAA,SAAAA,QAAA,CAAA+C,IAAA;QACA,KAAAnC,OAAA;MACA;QACA,KAAAA,OAAA;MACA;IACA;EACA;EACAoC,QAAA;IACA,KAAAF,UAAA;IACA,SAAAlC,OAAA;MACA,KAAAE,WAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}